<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>C2Serve - Create a Simple Server</title>

    <script type="text/javascript" src="Document.js"></script>
    <link rel="stylesheet" type="text/css" href="Basic.css"/>
      
</head>
<body onload="if (parent.adjustIFrameSize) parent.adjustIFrameSize(window);">

  <div>

   <div class="section" style="margin-top: 50px;">
    
      <h1>Create a Simple Server</h1>
    
      Starting a C2Serve REST service can be summarized in three steps:
      
      <ul>
      
        <li>
          Define the port to listen for incoming requests.
        </li>
        
        <li>
          Create the available REST resources and methods.
        </li>
        
        <li>
          Start the socket listener.
        </li>
        
      </ul>
      
      <h2>Define Server Port</h2>
      
      The server's port is simply a global integer value, defined in the class <code><i class="tn">C2SGlobalSettings</i></code>.
      The global instance can be accessed using the public static function <code><i class="tn">C2SGlobalSettings</i>::Settings()</code>:
      
      <div class="code">
        <code class="cpp">
        
          <i class="sw">#include</i> <i class="m">&quot;C2SGlobalSettings.h&quot;</i><br />
          <br />
          <i class="sw">int</i> <i class="fd">main</i>( <i class="sw">int</i>, <i class="sw">char</i> ** )<br />
          {<br />
          &nbsp;&nbsp;<i class="sw">using namespace</i> c2s;<br />
          &nbsp;&nbsp;<i class="tn">C2SGlobalSettings</i> &globalServerSettings = <i class="tn">C2SGlobalSettings</i>::Settings();<br />
          &nbsp;&nbsp;globalServerSettings.<i class="m">iPort</i> = 3344;<br />
          <br />
          &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
        </code>
      </div>
   
      <h2>Define REST Resource and Methods</h2>
      
      C2Serve provides a class <code><i class="tn">C2SRestResource</i></code>.
      Each instance of that class represents an actual REST resource at a specific context root of the server.
      To create a new resource call the static method <code><i class="tn">C2SRestResource::createRestResourceWithContextRoot()</i></code>.
      This function will create a new REST resource.
      You can now add REST methods by calling <code><i class="tn">C2SRestResource</i>::registerMethodPrototype()</code>.
      Finally, you will have to register the REST resource at the http server.
      Each http requests will be forwarded to one REST resource, identified by the path.
      If no resource matches, status 404 is returned (not found).
    
      <div class="code">
        <code class="cpp">
        
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
          
          <i class="sw">#include</i> <i class="m">&quot;C2SRestResourcePrototype.h&quot;</i><br />
          <i class="sw">#include</i> <i class="m">&quot;MyRestMethodImplementation.h&quot;</i><br />
        
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
          &nbsp;&nbsp;<i class="tn">std</i>::<i class="tn">string</i> sContextRoot = <i class="m">&quot;example/resource&quot;</i>;<br />
          &nbsp;&nbsp;<i class="tn">C2SRestResourcePrototype</i> *pResource =<br />
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i class="tn">C2SRestResourcePrototype</i>::createRestResourceWithContextRoot( sContextRoot );<br />
          &nbsp;&nbsp;pResource->registerMethodPrototype( <i class="sw">new</i> <i class="tn">MyRestMethodImplementation()</i> );<br />
          &nbsp;&nbsp;<i class="tn">C2SHttpServer</i>::registerResourcePrototype( pResource );<br />
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
        </code>
      </div>
   
      <h2>Start Socket Listener</h2>
    
        This is the easiest part. You simply have to call <code><i class="tn">C2SHttpServer</i>::run()</code>:
      
      <div class="code">
        <code class="cpp">
        
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
          
          <i class="sw">#include</i> <i class="m">&quot;C2SHttpServer.h&quot;</i><br />
        
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
          &nbsp;&nbsp;<i class="tn">C2SHttpServer</i>::run();<br />
          <br />
            &nbsp;&nbsp;&nbsp;&nbsp;...<br />
          <br />
        </code>
      </div>
   
    </div>
    
  </div>

</body>
</html>